# conf/fluent-bit.conf (핵심만)
[SERVICE]
    Flush        5
    Daemon       Off
    Parsers_File /fluent-bit/etc/parsers.conf
    Log_Level    info
    storage.path /var/lib/fluent-bit/storage

[INPUT]
    Name              tail
    Path              /var/lib/docker/containers/*/*-json.log
    Parser            json_parser
    Tag               docker.${name}                # 컨테이너명 태그에 넣기
    Mem_Buf_Limit     64MB
    Skip_Long_Lines   On
    storage.type      filesystem

[FILTER]
    Name   grep
    Match  *
    Regex  $log['service'] ^efk            # 서비스 이름이 efk* 인 것만

; [FILTER]
;   Name modify
;   Match *
;   Add env stage # 환경변수 운영환경에맞게 변경

[FILTER]
  Name record_modifier
  Match *
  Record hostname ${HOSTNAME}
  Record env stage


[OUTPUT]
    Name         forward
    Match        docker.*
    Host         fluentd
    Port         24224
    Retry_Limit  False
